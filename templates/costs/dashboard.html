{% extends 'base/base.html' %}
{% block title %}Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§{% endblock %}
{% block breadcrumb %}COSTS / DASHBOARD{% endblock %}
{% block content %}

<div class="page-header fade-up">
  <div class="page-title-group">
    <div class="page-eyebrow">COSTS / CYCLE ANALYSIS</div>
    <h1 class="page-title">Ø¬Ø²Ø¦ÛŒØ§Øª Ù‡Ø²ÛŒÙ†Ù‡ Ø³ÛŒÚ©Ù„â€ŒÙ‡Ø§</h1>
    <p class="page-subtitle">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ù‚ÛŒÙ‚ Ù‡Ø²ÛŒÙ†Ù‡ Ø¨Ø±Ù‚ØŒ Ø¢Ø¨ Ùˆ Ù‡Ø²ÛŒÙ†Ù‡ Ø¨Ù‡ Ø§Ø²Ø§ÛŒ Ù‡Ø± kg Ø²Ø¨Ø§Ù„Ù‡</p>
  </div>
  <a href="/reports/export/" class="btn btn-primary"><i class="fas fa-download me-2"></i>Excel</a>
</div>

<div class="stat-grid fade-up stagger-1">
  <div class="stat-card accent-amber">
    <div class="stat-header"><div class="stat-icon-wrap">ğŸ’°</div></div>
    <div class="stat-value" style="font-size:26px">{{ month_total|floatformat:0|default:0 }}</div>
    <div class="stat-label">Ù‡Ø²ÛŒÙ†Ù‡ Ø§ÛŒÙ† Ù…Ø§Ù‡ (Ø±ÛŒØ§Ù„)</div>
  </div>
  <div class="stat-card accent-blue">
    <div class="stat-header"><div class="stat-icon-wrap">âš¡</div></div>
    <div class="stat-value">{{ month_kwh|floatformat:0|default:0 }}</div>
    <div class="stat-label">Ù…ØµØ±Ù Ø¨Ø±Ù‚ (kWh)</div>
  </div>
  <div class="stat-card accent-green">
    <div class="stat-header"><div class="stat-icon-wrap">ğŸ“Š</div></div>
    <div class="stat-value">{{ avg_cost_per_kg|floatformat:0|default:0 }}</div>
    <div class="stat-label">Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù‡Ø²ÛŒÙ†Ù‡/kg</div>
  </div>
  <div class="stat-card accent-fire">
    <div class="stat-header"><div class="stat-icon-wrap">ğŸ”„</div></div>
    <div class="stat-value">{{ total_cycles|default:0 }}</div>
    <div class="stat-label">ØªØ¹Ø¯Ø§Ø¯ Ø³ÛŒÚ©Ù„</div>
  </div>
</div>

<div class="panel mt-6 fade-up stagger-2">
  <div class="panel-header">
    <div class="panel-title">ğŸ’³ Ø¬Ø²Ø¦ÛŒØ§Øª Ù‡Ø²ÛŒÙ†Ù‡ Ø³ÛŒÚ©Ù„â€ŒÙ‡Ø§</div>
    <div class="panel-subtitle">CYCLE COST BREAKDOWN</div>
  </div>
  <div class="panel-body" style="padding:0">
    <table class="data-table">
      <thead>
        <tr>
          <th>Ø¯Ø³ØªÚ¯Ø§Ù‡</th><th>Ø³ÛŒÚ©Ù„</th><th>Ù†ÙˆØ¹ Ø²Ø¨Ø§Ù„Ù‡</th>
          <th>Ø¨Ø±Ù‚ (kWh)</th><th>Ù‡Ø²ÛŒÙ†Ù‡ Ø¨Ø±Ù‚</th>
          <th>Ø¢Ø¨ (L)</th><th>Ù‡Ø²ÛŒÙ†Ù‡ Ø¢Ø¨</th>
          <th>Ú©Ø±Ø¨Ù† (kg)</th><th>Ù‡Ø²ÛŒÙ†Ù‡ Ú©Ù„</th><th>Ù‡Ø²ÛŒÙ†Ù‡/kg</th>
        </tr>
      </thead>
      <tbody>
      {% for r in records %}
      <tr>
        <td><div class="flex items-center gap-2">
          <span>{% if r.cycle.device.device_type == 'autoclave' %}ğŸ”¬{% else %}ğŸ”¥{% endif %}</span>
          <span class="td-primary">{{ r.cycle.device.name }}</span>
        </div></td>
        <td class="td-mono" style="color:var(--text-tertiary)">#{{ r.cycle.cycle_number }}</td>
        <td><span class="badge badge-ghost">{{ r.cycle.get_waste_type_display }}</span></td>
        <td class="td-mono" style="color:var(--amber)">{{ r.electricity_kwh|floatformat:2 }}</td>
        <td class="td-mono">{{ r.electricity_cost|floatformat:0 }}</td>
        <td class="td-mono" style="color:var(--plasma)">{{ r.water_liter|floatformat:0 }}</td>
        <td class="td-mono">{{ r.water_cost|floatformat:0 }}</td>
        <td class="td-mono" style="color:var(--acid)">{{ r.carbon_footprint_kg|floatformat:1 }}</td>
        <td class="td-mono" style="color:var(--crimson);font-weight:700">{{ r.total_cost|floatformat:0 }}</td>
        <td class="td-mono" style="color:var(--fire)">{{ r.cost_per_kg|floatformat:0 }}</td>
      </tr>
      {% empty %}
      <tr><td colspan="10" style="text-align:center;padding:40px;color:var(--text-tertiary)">Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
